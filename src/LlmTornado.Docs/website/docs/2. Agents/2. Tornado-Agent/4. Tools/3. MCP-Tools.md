# MCP Tools

## Overview

MCP (Model Context Protocol) tools allow agents to use standardized external tools provided by MCP servers. This enables seamless integration with a wide ecosystem of tools and services.

## Quick Start

 Please see [gmail-mcp-server](https://github.com/GongRzhe/Gmail-MCP-Server) for more details on setting up OAuth

```csharp
using LlmTornado;
using LlmTornado.Agents;
using LlmTornado.Chat.Models;
using LlmTornado.Mcp;

MCPServer gmailServer = new MCPServer(
    serverLabel: "gmail",
    command: "npx",
    arguments: new[] { "@gongrzhe/server-gmail-autoauth-mcp" },
    allowedTools: [
        "read_email",
        "draft_email",
        "search_emails"]);

await gmailServer.InitializeAsync(); // This will handle MCP Client connection to setup tools

TornadoAgent agent = new TornadoAgent(
    client,
    model: ChatModel.OpenAi.Gpt41.V41Mini,
    instructions: "You are a useful assistant for managing Gmail."
);

agent.AddTool(gmailServer.AllowedTornadoTools); // Register MCP tools to the agent

Conversation result = await agent.Run("Did mom respond?");

Console.WriteLine(result.Messages.Last().Content);
```


## HTTP Transport Configuration
To connect to an MCP server over HTTP, configure the transport settings as follows:
```csharp
using System.Collections.Generic;
using LlmTornado;
using LlmTornado.Agents;
using LlmTornado.Chat.Models;
using LlmTornado.Mcp;

Dictionary<string, string> headers = [];
headers["Authorization"] = $"Bearer {githubApiKey}";

MCPServer server = new MCPServer(
    "github",
    "https://api.githubcopilot.com/mcp",
    additionalConnectionHeaders: headers,
    allowedTools: allowedTools);

await server.InitializeAsync(); // This will handle MCP Client connection to setup tools

TornadoAgent agent = new TornadoAgent(
    client,
    model: ChatModel.OpenAi.Gpt41.V41Mini,
    instructions: "You are a useful assistant for managing Github."
);

agent.AddTool(server.AllowedTornadoTools); // Register MCP tools to the agent

Conversation result = await agent.Run("What repos do I have?");

Console.WriteLine(result.Messages.Last().Content);

```

### Server Management

### Error Handling

## Common Issues

### MCP Server Not Responding
**Solutions**:
- Verify server is running
- Check transport configuration
- Ensure network connectivity
- Review server logs

### Tools Not Available
**Solutions**:
- Confirm MCP server has tools registered
- Check agent initialization succeeded
- Verify server is compatible with protocol version

### Tool Execution Fails
**Solutions**:
- Validate tool parameters
- Check server error logs
- Ensure required dependencies are available
- Test tools independently

## Related Topics

- [Function Tools](./1.%20Function-Tools.md)
- [MCP Documentation](../../../3.%20MPC/MPC.md)
- [Agent Basics](../1.%20basics.md)
